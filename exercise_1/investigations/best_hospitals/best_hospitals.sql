Select Hospital_Name,  sum(Score)/800 as aggregateScore, sum(Score*Sample)/sum(Sample) as meanScore,   pow(stddev(Score),2) as varScore from (Select Provider_ID, avg( if(`Measure_Name`="Percent of newborns whose deliveries were scheduled early (1-3 weeks early), when a scheduled delivery was not medically necessary",Score*-1,Score) ) as Score, sum(Sample) as Sample from effective_hospital_s where Measure_Name in ("Discharge instructions","Healthcare workers given influenza vaccination","Immunization for influenza","Percent of newborns whose deliveries were scheduled early (1-3 weeks early), when a scheduled delivery was not medically necessary","Prophylactic Antibiotic Initiated Within One Hour Prior to Surgical Incision","Prophylactic antibiotic received within 1 hour prior to surgical incision","Prophylactic Antibiotic Selection for Surgical Patients","Prophylactic antibiotics discontinued within 24 hours after surgery end time") group by Provider_ID,Measure_Name) as cleanSet inner join hospital_general_s on cleanSet.Provider_ID = hospital_general_s.Provider_ID group by Hospital_Name order by aggregateScore DESC limit 10;
